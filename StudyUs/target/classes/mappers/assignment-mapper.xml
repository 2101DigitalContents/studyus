<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="assignmentMapper">
	<resultMap type="Assignment" id="assignmentResultMap">
		<id property="asNo" column="AS_NO"></id>
		<result property="stNo" column="ST_NO"></result>
		<result property="asName" column="AS_NAME"></result>
		<result property="asContents" column="AS_CONTENTS"></result>
		<result property="asInsertDate" column="AS_INSERTDATE"></result>
		<result property="asDeadLine" column="AS_DEADLINE"></result>
		<result property="asFileName" column="AS_FILENAME"></result>
		<result property="asMotherNo" column="AS_MOTHER_NO"></result>
		<result property="asStatus" column="AS_STATUS"></result>
	</resultMap>
	
	<!-- 리스트 -->
	<select id="selectListCount" resultType="_int">
		SELECT COUNT(*) FROM ASSIGNMENT
		WHERE AS_MOTHER_NO IS NULL 
		AND ST_NO = #{stNo}
		AND AS_STATUS = 1
	</select>
	
	<select id="selectAllList" resultMap="assignmentResultMap">
		SELECT * FROM ASSIGNMENT
		WHERE AS_MOTHER_NO IS NULL
		AND ST_NO = #{stNo}
		AND AS_STATUS = 1
		ORDER BY AS_NO DESC
	</select>
	
	<!-- 디테일 -->
	<select id="selectOne" resultMap="assignmentResultMap">
		SELECT * FROM ASSIGNMENT
		WHERE AS_NO = #{asNo}
		AND AS_STATUS = 1
	</select>
	
	<!-- 등록 -->
	<insert id="insertAssignment" parameterType="Assignment">
		INSERT INTO ASSIGNMENT VALUES (
			SEQ_ASSIGNMENT.NEXTVAL, #{stNo}, #{asName}, #{asContents}, TO_CHAR(SYSDATE), TO_CHAR(#{asDeadLine}), #{asFileName}, DEFAULT, DEFAULT 
		)
	</insert>
</mapper>